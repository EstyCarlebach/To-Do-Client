{"ast":null,"code":"import axios from \"axios\";\nimport { jwtDecode } from 'jwt-decode';\naxios.defaults.baseURL = process.env.REACT_APP_API_URL;\nconsole.log('process.env.API_URL', process.env.REACT_APP_API_URL);\nsetAuthorizationBearer();\nfunction setAuthorizationBearer() {\n  const accessToken = localStorage.getItem(\"access_token\");\n  if (accessToken) {\n    axios.defaults.headers.common[\"Authorization\"] = `Bearer ${accessToken}`;\n  }\n}\naxios.interceptors.response.use(function (response) {\n  return response;\n}, function (error) {\n  if (error.response.status === 401) {\n    return window.location.href = \"/login\";\n  }\n  return Promise.reject(error);\n});\nexport default {\n  saveAccessToken: authResult => {\n    localStorage.setItem(\"access_token\", authResult.token);\n    setAuthorizationBearer();\n  },\n  getLoginUser: () => {\n    const accessToken = localStorage.getItem(\"access_token\");\n    if (accessToken) {\n      return jwtDecode(accessToken);\n    }\n    return null;\n  },\n  logout: () => {\n    localStorage.setItem(\"access_token\", \"\");\n  },\n  register: async (email, password) => {\n    const res = await axios.post(\"/register\", {\n      email,\n      password\n    });\n    saveAccessToken(res.data);\n  },\n  login: async (email, password) => {\n    const res = await axios.post(\"/login\", {\n      email,\n      password\n    });\n    saveAccessToken(res.data);\n  },\n  getPublic: async () => {\n    const res = await axios.get(\"/public\");\n    return res.data;\n  },\n  getPrivate: async () => {\n    const res = await axios.get(\"/private\");\n    return res.data;\n  }\n};","map":{"version":3,"names":["axios","jwtDecode","defaults","baseURL","process","env","REACT_APP_API_URL","console","log","setAuthorizationBearer","accessToken","localStorage","getItem","headers","common","interceptors","response","use","error","status","window","location","href","Promise","reject","saveAccessToken","authResult","setItem","token","getLoginUser","logout","register","email","password","res","post","data","login","getPublic","get","getPrivate"],"sources":["C:/Users/This User/Documents/מסלול/שנה ב/פרויקטים/פרקטי קוד/בסיעתא דשמיא פרויקט 3/Client/ToDoListReact/src/Service.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { jwtDecode } from 'jwt-decode'; \r\n\r\naxios.defaults.baseURL = process.env.REACT_APP_API_URL;\r\nconsole.log('process.env.API_URL', process.env.REACT_APP_API_URL)\r\nsetAuthorizationBearer();\r\n\r\n\r\n\r\nfunction setAuthorizationBearer() {\r\n  const accessToken = localStorage.getItem(\"access_token\");\r\n  if (accessToken) {\r\n    axios.defaults.headers.common[\"Authorization\"] = `Bearer ${accessToken}`;\r\n  }\r\n}\r\n\r\naxios.interceptors.response.use(\r\n  function(response) {\r\n    return response;\r\n  },\r\n  function(error) {\r\n    if (error.response.status === 401) {\r\n      return (window.location.href = \"/login\");\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport default {\r\n   saveAccessToken:(authResult)=> {\r\n    localStorage.setItem(\"access_token\", authResult.token);\r\n    setAuthorizationBearer();\r\n  },\r\n  getLoginUser: () => {\r\n    const accessToken = localStorage.getItem(\"access_token\");\r\n    if (accessToken) {\r\n      return jwtDecode(accessToken);\r\n    }\r\n    return null;\r\n  },\r\n\r\n  logout:()=>{\r\n    localStorage.setItem(\"access_token\", \"\");\r\n  },\r\n\r\n  register: async (email, password) => {\r\n    const res = await axios.post(\"/register\", { email, password });\r\n    saveAccessToken(res.data);\r\n  },\r\n\r\n  login: async (email, password) => {\r\n    const res = await axios.post(\"/login\", { email, password });\r\n    saveAccessToken(res.data);\r\n  },\r\n\r\n\r\n  getPublic: async () => {\r\n    const res = await axios.get(\"/public\");\r\n    return res.data;\r\n  },\r\n\r\n  getPrivate: async () => {\r\n    const res = await axios.get(\"/private\");\r\n    return res.data;\r\n  },\r\n};\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,SAAS,QAAQ,YAAY;AAEtCD,KAAK,CAACE,QAAQ,CAACC,OAAO,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB;AACtDC,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAEJ,OAAO,CAACC,GAAG,CAACC,iBAAiB,CAAC;AACjEG,sBAAsB,CAAC,CAAC;AAIxB,SAASA,sBAAsBA,CAAA,EAAG;EAChC,MAAMC,WAAW,GAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;EACxD,IAAIF,WAAW,EAAE;IACfV,KAAK,CAACE,QAAQ,CAACW,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,UAAUJ,WAAW,EAAE;EAC1E;AACF;AAEAV,KAAK,CAACe,YAAY,CAACC,QAAQ,CAACC,GAAG,CAC7B,UAASD,QAAQ,EAAE;EACjB,OAAOA,QAAQ;AACjB,CAAC,EACD,UAASE,KAAK,EAAE;EACd,IAAIA,KAAK,CAACF,QAAQ,CAACG,MAAM,KAAK,GAAG,EAAE;IACjC,OAAQC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;EACzC;EACA,OAAOC,OAAO,CAACC,MAAM,CAACN,KAAK,CAAC;AAC9B,CACF,CAAC;AAED,eAAe;EACZO,eAAe,EAAEC,UAAU,IAAI;IAC9Bf,YAAY,CAACgB,OAAO,CAAC,cAAc,EAAED,UAAU,CAACE,KAAK,CAAC;IACtDnB,sBAAsB,CAAC,CAAC;EAC1B,CAAC;EACDoB,YAAY,EAAEA,CAAA,KAAM;IAClB,MAAMnB,WAAW,GAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;IACxD,IAAIF,WAAW,EAAE;MACf,OAAOT,SAAS,CAACS,WAAW,CAAC;IAC/B;IACA,OAAO,IAAI;EACb,CAAC;EAEDoB,MAAM,EAACA,CAAA,KAAI;IACTnB,YAAY,CAACgB,OAAO,CAAC,cAAc,EAAE,EAAE,CAAC;EAC1C,CAAC;EAEDI,QAAQ,EAAE,MAAAA,CAAOC,KAAK,EAAEC,QAAQ,KAAK;IACnC,MAAMC,GAAG,GAAG,MAAMlC,KAAK,CAACmC,IAAI,CAAC,WAAW,EAAE;MAAEH,KAAK;MAAEC;IAAS,CAAC,CAAC;IAC9DR,eAAe,CAACS,GAAG,CAACE,IAAI,CAAC;EAC3B,CAAC;EAEDC,KAAK,EAAE,MAAAA,CAAOL,KAAK,EAAEC,QAAQ,KAAK;IAChC,MAAMC,GAAG,GAAG,MAAMlC,KAAK,CAACmC,IAAI,CAAC,QAAQ,EAAE;MAAEH,KAAK;MAAEC;IAAS,CAAC,CAAC;IAC3DR,eAAe,CAACS,GAAG,CAACE,IAAI,CAAC;EAC3B,CAAC;EAGDE,SAAS,EAAE,MAAAA,CAAA,KAAY;IACrB,MAAMJ,GAAG,GAAG,MAAMlC,KAAK,CAACuC,GAAG,CAAC,SAAS,CAAC;IACtC,OAAOL,GAAG,CAACE,IAAI;EACjB,CAAC;EAEDI,UAAU,EAAE,MAAAA,CAAA,KAAY;IACtB,MAAMN,GAAG,GAAG,MAAMlC,KAAK,CAACuC,GAAG,CAAC,UAAU,CAAC;IACvC,OAAOL,GAAG,CAACE,IAAI;EACjB;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}